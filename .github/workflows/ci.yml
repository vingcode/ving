name: CI

on:
  push:
    branches: [ '*' ]
  pull_request:
    branches: [ '*' ]

jobs:
  build-and-test:
    runs-on: ubuntu-latest
    
    steps:
    - uses: actions/checkout@v3
    
    - name: Install dependencies
      run: |
        sudo apt-get update
        sudo apt-get install -y gcc make
    
    - name: Build
      run: |
        make clean
        make
    
    - name: Run tests
      run: |
        echo "style:black" > test.ving
        echo "title: Test" >> test.ving
        echo "text(bold): Hello World" >> test.ving
        echo "button(st1,link:https://example.com):Click" >> test.ving
        echo "video(controls):test.mp4" >> test.ving
        echo "audio(controls):test.mp3" >> test.ving
        ./vingc test.ving test.html
        test -f test.html && echo "✓ Build successful" || exit 1
        grep -q "Hello World" test.html && echo "✓ Content check passed" || exit 1
        grep -q "Click" test.html && echo "✓ Button check passed" || exit 1
        echo "All tests passed!"

